#バックアップ・レストア

baserCMSのデータベース構造とデータのバックアップ、レストアが行える

URL

```
/admin/tools/maintenance
```

##バックアップ

* スキーマの書き出し（CakeSchema）
 * {テーブル名}.php
 * 一時フォルダに一旦保存
* データの書出し（CSVファイル）
 * {テーブル名}.csv
 * 一時フォルダに一旦保存
* ZIP圧縮＆ダウンロード
 * 一時フォルダに保存されたスキーマファイルとCSVファイルをまとめて圧縮
 * ZIPファイルをダウンロード
* クリーニング
 * 一時フォルダに保存されたファイルを消去

##レストア

* ファイルアップロード
 * 	ZIPファイルをアップロード
* ZIP解凍
 * 	アップロードされたZIPファイルを一時フォルダに解凍
* テーブル削除
 * 	データベースの既存テーブルを削除
* テーブル生成
 * 	一時フォルダのスキーマファイルを元にテーブル構造を構築する
 * 	失敗時の被害を少なくする為、１テーブルずつ処理を行い失敗した時点で中止する
* データ読み込み
 * 	一時フォルダのCSVデータを読み込む
* クリーニング
 * 	一時フォルダに保存されたファイルを消去


##既知の問題点

データベースの生成、データ読込に失敗した際、ロールバックする処理が実装されていない為、データベースの状態が中途半端な状態となり、baserCMS自体が起動しない恐れがあり、バックアップデータが間違いなく正常な状態が前提となっている。

