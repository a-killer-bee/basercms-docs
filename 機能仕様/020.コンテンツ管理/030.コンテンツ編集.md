# コンテンツ編集仕様

## 基本仕様

コントローラーで、BcContentsComponent を利用する事で、コンテンツの基本項目を設定するフォームを、編集画面に配置する事ができる。

```php
public $components = ['BcContents' => ['useForm' => true]];
```

## 公開状態設定機能
## アイキャッチ機能
## プレビュー機能
自動的プレビューボタンを表示する。  
リアルタイムのプレビューに対応するかどうかは、setting.php で定義する。
## 削除機能
自動的に削除ボタンを表示する。  
フォルダの場合は、自動的に配下のコンテンツも削除する。
## 一覧に戻る機能
## サブメニュー自動登録
コンテンツ管理用のサブメニューを自動的に表示する。

## コンテンツ連携更新
### マルチコンテンツの場合

モデルで、BcContentsBehavior を利用する事で、自動的に連携更新を実装する事ができる。

	public $actAs = ['BcContents'];

### シングルコンテンツの場合

## コンテンツデータの参照

BcContentsComponent のメソッドを明示的に実行して取得する。

```php
BcContentsComponent::getContent()
```

## 関連コンテンツ
サブサイトを設定している場合、同一階層構造のコンテンツを関連コンテンツとして一覧を表示する。

### 関連コンテンツ編集画面遷移機能
関連サイトの編集画面に移動する事ができる。

### 関連コンテンツ確認機能
関連サイトのフロントページを確認する事ができる。

### 関連コンテンツエイリアス作成機能
現在のコンテンツを元に関連コンテンツとしてエイリアスを作成する事ができる。

### 関連コンテンツコピー作成機能
現在のコンテンツを元に関連コンテンツとしてコピーを作成する事ができる。

## コンテンツ更新時の連携処理

```php
・Page::beforeValidate()
	・Content::beforeValidate() 
		// name が同一フォルダで重複した場合にリネームする
・Page::afterSave()
     ・Content::createContent()
		// ツリーコンテンツを生成する
          ・Content::afterSave()
               ・Content::updateSystemData()
               		// URLの決定、公開状態の更新、関連サイトコンテンツの紐付けを行う
               ・Content::updateChildren()
               		// 子コンテンツのURLと関連データを更新
               ・Content::updateRelateSubSiteContent()
               		// メインサイトの場合、連携設定がされている子サイトのエイリアスを追加・更新する
     ・Page::createPageTemplate()
     	// 固定ページテンプレートを生成する
     ・Page::createSearchIndex()
     	// 検索インデックスを生成する
```

